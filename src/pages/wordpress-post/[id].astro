---
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const response = await fetch('https://vizen.co.uk/wp-json/wp/v2/posts?_embed');
  const posts = await response.json();
  
  return posts.map((post) => ({
    params: { id: post.id.toString() },
    props: { post },
  }));
}

const { post } = Astro.props;
---

<Layout title={post.title.rendered}>
  <article class="max-w-3xl mx-auto">
    <h1 class="text-4xl font-heading font-bold mb-4" set:html={post.title.rendered} />
    <p class="text-gray-600 mb-4">
      {new Date(post.date).toLocaleDateString()} | {post._embedded['wp:term'][0][0].name}
    </p>
    {post._embedded['wp:featuredmedia'] && (
      <img 
        src={post._embedded['wp:featuredmedia'][0].source_url} 
        alt={post.title.rendered}
        class="w-full h-64 object-cover mb-8 rounded-lg"
      />
    )}
    <div class="prose prose-lg" set:html={post.content.rendered} />
  </article>
</Layout>